{% extends "base.jinja" %}

{% set title = event.name %}
{% set iteration = 5 %}
{% set mode = "admin" %}


{% block content %}
<h1 class="mt-4">{{ title }}</h1>
<div class="my-2">
    {{ event.description }}
</div>
<div class="my-2">
    <label class="datalabel">Event date</label>
    {{ event.displayDate() }}
</div>
<div class="my-2">
    <label class="datalabel">Tickets</label>
    {% for ticketType in event.getTicketTypes() %}
        {% if loop.first %}
        <table>
            <tbody>
        {% endif %}
                <tr>
                    <td class="pe-3">{{ ticketType.name }}</td>
                    <td class="px-3">{{ ticketType.description }}</td>
                    <td class="px-3">ï¿¥{{ ticketType.cost }}</td>
                    <td class="px-3">{{ticketType.ticketsSold() }} of {{ticketType.ticketsTotal }} sold
                        {% if ticketType.isSoldOut() %}
                        <br><span style="color: red;">Sold Out!</span>
                        {% endif %}
                    </td>
                    <td class="ps-3">
                        <a href="{{ url_for('adminUpdateTicketType', ticketTypeId=ticketType.id()) }}" role="button" class="btn btn-outline-primary btn-sm">Update</a>
                        {% if ticketType.ticketsSold() == 0 %}
                        <a href="{{ url_for('adminDeleteTicketType', ticketTypeId=ticketType.id()) }}" role="button" class="btn btn-outline-primary btn-sm">Delete</a>
                        {% else %}
                        <a href="{{ url_for('adminTicketList', ticketTypeId=ticketType.id()) }}" role="button" class="btn btn-outline-primary btn-sm">Tickets</a>
                        {% endif %}
                    </td>
                </tr>
        {% if loop.last %}
            {% if event.getTicketTypes()|length > 1 %}
                <tr>
                    <td class="pe-3">Total</td>
                    <td></td>
                    <td></td>
                    <td class="px-3">{{event.ticketsSold() }} of {{event.ticketsTotal() }} sold
                        {% if event.isSoldOut() %}
                        <br><span style="color: red;">Sold Out!</span>
                        {% endif %}
                    </td>
                    <td></td>
                </tr>
            {% endif %}
            </tbody>
        </table>
        {% endif %}
    {% else %}
    <p>No ticket types have been defined.</p>
    {% endfor %}
</div>
<div class="mt-4">
    <a href="{{ url_for('adminUpdateEvent', eventId=event.id()) }}" role="button" class="btn btn-outline-primary btn-sm">Update Event</a>
    <a href="{{ url_for('adminDeleteEvent', eventId=event.id()) }}" role="button" class="btn btn-outline-primary btn-sm">Delete Event</a>
    <a href="{{ url_for( 'adminCreateTicketType', eventId=event.id() ) }}" role="button" class="btn btn-outline-primary btn-sm">New Ticket Type</a>
    <a href="{{ url_for('adminEventList') }}" role="button" class="btn btn-primary btn-sm">Back</a>
</div>
{% endblock %}
